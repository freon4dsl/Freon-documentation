// Generated by the Freon Language Generator.
import { net } from "net.akehurst.language-agl-processor";
import SPPTBranch = net.akehurst.language.api.sppt.SPPTBranch;
import { SimpleNumber, Fraction, NumberConcept, Grade } from "../../language/gen/index.js";
import { EducationSyntaxAnalyser } from "./EducationSyntaxAnalyser.js";
import { FreNodeReference } from "@freon4dsl/core";

export class EducationCommonSyntaxAnalyserPart {
    mainAnalyser: EducationSyntaxAnalyser;

    constructor(mainAnalyser: EducationSyntaxAnalyser) {
        this.mainAnalyser = mainAnalyser;
    }

    /**
     * Method to transform branches that match the following rule:
     * SimpleNumber = numberLiteral ;
     * @param branch
     * @private
     */
    public transformSimpleNumber(branch: SPPTBranch): SimpleNumber {
        // console.log('transformSimpleNumber called: ' + branch.name);
        let __value: number;
        const children = this.mainAnalyser.getChildren(branch);
        __value = this.mainAnalyser.transformSharedPackedParseTreeNode(children[0]); // RHSPrimEntry

        return SimpleNumber.create({
            value: __value,
            parseLocation: this.mainAnalyser.location(branch),
        });
    }

    /**
     * Method to transform branches that match the following rule:
     * Fraction = numberLiteral '\/' numberLiteral ;
     * @param branch
     * @private
     */
    public transformFraction(branch: SPPTBranch): Fraction {
        // console.log('transformFraction called: ' + branch.name);
        let __numerator: number;
        let __denominator: number;
        const children = this.mainAnalyser.getChildren(branch);
        __numerator = this.mainAnalyser.transformSharedPackedParseTreeNode(children[0]); // RHSPrimEntry
        __denominator = this.mainAnalyser.transformSharedPackedParseTreeNode(children[2]); // RHSPrimEntry

        return Fraction.create({
            numerator: __numerator,
            denominator: __denominator,
            parseLocation: this.mainAnalyser.location(branch),
        });
    }

    /**
     * Method to transform branches that match the following rule:
     * NumberConcept = SimpleNumber
     *    | Fraction  ;
     * @param branch
     * @private
     */
    public transformNumberConcept(branch: SPPTBranch): NumberConcept {
        // console.log('transformNumberConcept called: ' + branch.name);
        return this.mainAnalyser.transformSharedPackedParseTreeNode(branch.nonSkipChildren.toArray()[0]);
    }

    /**
     * Method to transform branches that match the following rule:
     * Grade = 'gradeA'
     *	| 'gradeB'
     *	| 'gradeC'
     *	| 'gradeD'
     *	| 'gradeE'
     *	| 'gradeF' ;
     * @param branch
     * @private
     */
    public transformGrade(branch: SPPTBranch): Grade {
        const choice = branch.nonSkipMatchedText;
        if (choice === "gradeA") {
            return Grade.gradeA;
        } else if (choice === "gradeB") {
            return Grade.gradeB;
        } else if (choice === "gradeC") {
            return Grade.gradeC;
        } else if (choice === "gradeD") {
            return Grade.gradeD;
        } else if (choice === "gradeE") {
            return Grade.gradeE;
        } else if (choice === "gradeF") {
            return Grade.gradeF;
        } else {
            return null;
        }
    }
}
